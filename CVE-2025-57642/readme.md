# Shell Upload Vulnerability in Tourism Management System 2.0

## Description

This repository highlights a **Shell Upload vulnerability** in **Tourism Management System 2.0**. The vulnerability allows an attacker to upload and execute arbitrary PHP shell scripts on the server, leading to **remote code execution** and **unauthorized access** to the system. This can result in the compromise of sensitive data and system functionality.

## Affected Version

- **Tourism Management System 2.0**

## Steps to Reproduce

1. **Login to Admin Panel**: Use valid credentials to log in to the admin panel.
2. **Create Tour Package**: Navigate to the "Create Tour Package" section.
3. **Upload Malicious PHP File**: In the "Package Image Upload" field, upload a PHP file (e.g., `test.php`).
4. **Submit Form**: Fill in the necessary form fields and submit the package.
5. **Check Uploaded File**: After the upload is complete, verify that the PHP file has been uploaded and is executable.

## Impact

Exploitation of this vulnerability can have serious consequences, including:

- **Remote Code Execution (RCE)**: Attackers can upload malicious PHP scripts and execute them on the server.
- **Unauthorized Access**: Attackers can gain unauthorized control over the system.
- **Data Compromise**: Sensitive information and system functionality can be exposed or manipulated.

## Mitigation and Recommendations

To mitigate the **Shell Upload vulnerability** in the Tourism Management System 2.0 and prevent attackers from uploading and executing malicious files, consider implementing the following security measures:

### 1. **Restrict File Types**
   - Only allow file uploads for specific types of files that are required for the application. In this case, only image files (such as `.jpg`, `.png`, `.gif`) should be allowed.
   - **Validation on both client and server side**:
     - On the **client side**, ensure that the file type is validated before submission.
     - On the **server side**, check the file extension and MIME type of the uploaded file to ensure it is a valid image format and not an executable (e.g., `.php`, `.exe`).

### 2. **File Content Inspection**
   - Use content-based validation to ensure the uploaded file's content matches its extension and MIME type. For example, even if a file has a `.jpg` extension, its content might not be an image. Implement the following:
     - **Check MIME type**: Verify the MIME type returned by the `fileinfo()` function or a similar method.
     - **Check file signatures**: Use methods to inspect the file header and verify that it corresponds to the expected format (e.g., `magic bytes` for images).
     
### 3. **Disable PHP Execution in Uploaded Folders**
   - **Prevent script execution** in directories where user uploads are stored. This can be achieved by adding a `.htaccess` file (for Apache) or configuring your web server to prevent execution in certain directories.
     - Example for Apache:
       ```apache
       <Files *.php>
           Deny from all
       </Files>
       ```
     - Example for Nginx:
       ```nginx
       location ~* \.php$ {
           deny all;
       }
       ```

### 4. **Rename Uploaded Files**
   - Rename the uploaded files using a random string or UUID to avoid predictable file names. This will make it difficult for attackers to guess the names of uploaded files and potentially execute them.

### 5. **Limit File Upload Size**
   - Set limits on the size of files that can be uploaded. Large file uploads could be a sign of malicious activity, and limiting file sizes can reduce the risk of abuse.
   - Example: Set a maximum file size for uploads (e.g., 2MB for images).

### 6. **Use Web Application Firewalls (WAF)**
   - Implement a **WAF** to filter and monitor HTTP requests for malicious payloads. Many WAFs come with predefined rules to block common attacks, including file upload exploits.
   - WAFs like **Cloudflare**, **ModSecurity**, or **AWS WAF** can help block malicious file uploads in real-time.

### 7. **Enable Security Headers**
   - Ensure that proper security headers are set to protect against certain attacks:
     - **X-Content-Type-Options**: Prevents browsers from interpreting files as a different MIME type.
     - **Content-Security-Policy (CSP)**: Prevents the execution of inline scripts and loading of unauthorized resources.
     - **Strict-Transport-Security (HSTS)**: Forces clients to communicate with the server over HTTPS.

### 8. **Monitor and Audit File Uploads**
   - Regularly audit and log all file upload actions. Keep detailed logs of which files are uploaded, by whom, and any errors that occur during the upload process. Set up an alerting mechanism to notify administrators of any suspicious activity, such as the upload of executable files or files with unusual extensions.

### 9. **Conduct Regular Security Audits and Penetration Testing**
   - Conduct **regular vulnerability assessments**, security audits, and **penetration testing** to ensure your system is secure and that vulnerabilities like this are caught early.
   - Utilize automated vulnerability scanning tools as well as manual testing methods to identify potential weaknesses in the system.

### 10. **User Role Management**
   - **Limit the permissions** of users who can upload files. If file uploads are not necessary for all users, restrict access to only those who need it (e.g., administrators or trusted users).
   - Ensure that users cannot **upload files with administrative privileges** unless absolutely required for their role.

---

Implementing these measures will significantly reduce the risk of Shell Upload vulnerabilities and other file upload-related attacks. The goal is to make the system more resilient and protect it from unauthorized access or malicious exploitation.

### Key Points:
- The README provides a detailed explanation of the vulnerability, its impact, and how to reproduce the issue.
- It also includes recommended mitigations to help secure the system.
- I've formatted the example HTTP request to make it easy for users to understand the exact steps.

Feel free to adjust any sections as needed!
